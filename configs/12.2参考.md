  ### 目标概述                                                                                                                                                                                    
                                                                                                                                                                                                  
  - 在 backend/sql/analysis_beihai_sub.sql 中新建两个视图：                                                                                                                                       
      1. analysis_beihai_sub_daily
      2. analysis_beihai_sub_sum                                                                                                                                                                  
  - 逻辑基于现有的 analysis_company_daily 与 analysis_company_sum（文件：backend/sql/analysis.sql），只是将维度从 company 扩展到 company + sheet_name，且仅针对 company='BeiHai'、sheet_name 属于 
    BeiHai_co_generation_Sheet 或 BeiHai_water_boiler_Sheet。                                                                                                                                     
                                                                                                                                                                                                  
  ### 数据来源与限制                                                                                                                                                                              
                                                                                                                                                                                                  
  - 仍然读取 daily_basic_data 与 constant_data 表，字段与现有视图一致。                                                                                                                           
  - base CTE 必须加入 sheet_name，并过滤：                                                                                                                                                        
      - company='BeiHai'                                                                                                                                                                          
      - sheet_name IN ('BeiHai_co_generation_Sheet','BeiHai_water_boiler_Sheet')                                                                                                                  
  - 计算过程中无需定制。若 daily_basic_data 中缺少某数据，结果为 0/空即可；不需要对两个 sheet 做额外判断。                                                                                        
                                                                                                                                                                                                  
  ### 只输出以下 9 个计算指标                                                                                                                                                                     
                                                                                                                                                                                                  
  | item | item_cn |                                                                                                                                                                              
  | --- | --- |                                                                                                                                                                                   
  | eco_inner_heat_supply_income | 其中：内售热收入 |                                                                                                                                             
  | eco_coal_cost | 煤成本 |                                                                                                                                                                      
  | eco_purchased_power_cost | 外购电成本 |                                                                                                                                                       
  | eco_purchased_water_cost | 购水成本 |                                                                                                                                                         
  | eco_measurable_auxiliary_materials | 可计量辅材成本 |                                                                                                                                         
  | eco_direct_income | 直接收入 |                                                                                                                                                                
  | eco_marginal_profit | 边际利润 |                                                                                                                                                              
  | eco_comparable_marginal_profit | 可比煤价边际利润 |                                                                                                                                           
  | rate_overall_efficiency | 全厂热效率 |                                                                                                                                                        
                                                                                                                                                                                                  
  > 其他 calc_* CTE 可以保留作为依赖（例如 calc_power、calc_hot_water 等），但最终 UNION ALL 输出只需要上述 9 条记录。
                                                                                                                                                                                                  
  ### 日视图 (analysis_beihai_sub_daily)                                                                                                                                                          
                                                                                                                                                                                                  
  - 参考 analysis_company_daily 的结构：                                                                                                                                                          
      - params / anchor_dates / window_defs                                                                                                                                                       
      - base、const_biz/const_peer                                                                                                                                                                
      - 所有需要的 calc_*（仅为上述 9 个及其依赖）                                                                                                                                                
  - 最终结果：                                                                                                                                                                                    
                                                                                                                                                                                                  
    SELECT * FROM base                                                                                                                                                                            
    UNION ALL                                                                                                                                                                                     
    SELECT * FROM calc_selected;  -- calc_selected 只 union 那 9 个指标                                                                                                                           
                                                                                                                                                                                                  
  ### 累计视图 (analysis_beihai_sub_sum)                                                                                                                                                          
                                                                                                                                                                                                  
  - 参考 analysis_company_sum，                                                                                                                                                                   
      - 使用 phoenix.sum_start_date / phoenix.sum_end_date，区间累积逻辑与原文件一致。                                                                                                            
      - base 仍带 sheet_name，并过滤北海两个模板。                                                                                                                                                
      - calc_* 与 daily 版本同样仅输出 9 个指标。                                                                                                                                                 
  - 最终结构同样是 base UNION ALL calc_selected。                                                                                                                                                 
                                                                                                                                                                                                  
  ### 输出字段                                                                                                                                                                                    
                                                                                                                                                                                                  
  - 与原视图完全一致：sheet_name, company, company_cn, item, item_cn, unit, biz_date, peer_date, value_biz_date, value_peer_date                                                                  
                                                                                                                                                                                                  
  ### 参考文件                                                                                                                                                                                    
                                                                                                                                                                                                  
  - backend/sql/analysis.sql：                                                                                                                                                                    
      - analysis_company_daily、analysis_company_sum 的 CTE 结构和计算公式                                                                                                                        
  - 需要配合 daily_basic_data / constant_data 的列含义                                                                                                                                            
                                                                                                                                                                                                  
  ### 验证建议                                                                                                                                                                                    
                                                                                                                                                                                                  
  1. 对任意日期（或区间）查询新视图与已有 analysis_company_* 中 company='BeiHai' 的结果，确认 9 个指标加总后与旧视图一致。                                                                        
  2. 确保两个 sheet 都能产生记录（若缺数据，值可为 0）。                                                                                                                                          
                                                                                                                                                                                                  
  ———                              